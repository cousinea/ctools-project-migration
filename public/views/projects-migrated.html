
<div ng-if="!migratedProjects.length && !migratedProjectsError" class="no-items">
	There are no completed exports at this time.
</div>

<div ng-if="migratedProjectsError" class="alert alert-danger" role="alert">
	<span class="emoji">ðŸ¤•</span> There was an error retrieving completed migrations!
</div>

<div ng-if="migratedProjects.length && !migratedProjectsError">
	<ul class="list-group" style="margin-bottom:0">
  	<li class="list-group-item" ng-repeat="migratedProject in migratedProjects">
  		<!--//this is not very good, but leaves the model untouched for polling needs
  		and presents a categorized view -->
  		<div style="border-bottom: 1px solid #ddd;margin:-6px -13px 10px;padding:0 5px 5px 5px" ng-if ="migratedProject.site_id !== migratedProjects[$index - 1].site_id">
  			<h4 class="site-header">{{migratedProject.site_name}}</h4>
  		</div>
  		<div class="row">
	  		<div class="col-md-12 col-lg-12 col-sm-12 col-xs-12">
	    			{{migratedProject.tool_name}} <small class="muted">({{migratedProject.end_time | date:'MM/dd h:mma'}})</small>
		  	</div>
		  </div>
		  <div class="row">
				<div class="col-md-6 col-lg-6 col-sm-6 col-xs-6">
				  <span ng-show="migratedProject.destination_type==='Box' && migratedProject.destination_url">
				    <a href ="{{migratedProject.destination_url}}" target="_blank">
				      Exported to
				      <span class="sr-only">Go to Box folder for content migrated from site {{migratedProject.site_name}}</span>
				      <span aria-hidden="true" ng-if="migratedProject.destination_folder">{{migratedProject.destination_type}} - {{migratedProject.destination_folder}}</span>
              <span ng-if="!migratedProject.destination_folder">{{migratedProject.destination_type}}</span>
				    </a>
				  </span>
				 <span ng-show="migratedProject.destination_url===null">Exported to <span ng-if="migratedProject.destination_type==='mailarchivezip'">zip</span><span ng-if="migratedProject.destination_type!=='mailarchivezip'">{{migratedProject.destination_type}}</span></span>
         <span ng-show="migratedProject.migrated_by"> by {{migratedProject.migrated_by}}</span>
				</div>
        <div class="col-md-6 col-lg-6 col-sm-6 col-xs-6" style="text-align:right">
          <small ng-show="migratedProject.status.counts.successes ===0 && migratedProject.status.counts.errors ===0">
            Nothing got migrated.
          </small>
          <small ng-show="migratedProject.status.counts.successes && migratedProject.status.counts.successes !==0">
            {{migratedProject.status.counts.successes}}
            <span ng-show="migratedProject.status.counts.successes === 1">success</span>
            <span ng-show="migratedProject.status.counts.successes > 1">successes</span>
          </small>
          <small ng-show="migratedProject.status.counts.partial_successes && migratedProject.status.counts.partial_successes !==0">
            {{migratedProject.status.counts.successes}} partial
            <span ng-show="migratedProject.status.counts.partial_successes === 1">success</span>
            <span ng-show="migratedProject.status.counts.partial_successes > 1">successes</span>
          </small>
          <small ng-show="migratedProject.status.counts.errors && migratedProject.status.counts.errors !==0">
            {{migratedProject.status.counts.errors}}
            <span ng-show="migratedProject.status.counts.errors === 1">error</span>
            <span ng-show="migratedProject.status.counts.errors > 1">errors</span>
          </small>
          <small ng-show="
            (
              migratedProject.status.details &&
              migratedProject.status.details.add_members.counts.partial_successes !==0 ||
              migratedProject.status.details &&
              migratedProject.status.details.add_members.counts.errors !==0
            ) ||
            (
            migratedProject.status.counts.errors &&
            migratedProject.status.counts.errors !==0) ||
            (migratedProject.status.counts.partial_successes &&
            migratedProject.status.counts.partial_successes !==0
            ) ||
            migratedProject.status.status!=='OK' && !migratedProject.status.counts.length
            "
          >
            <br>
            <a href="" data-toggle="modal" data-target="#reportModal" ng-click="showDetails($index, migratedProject.site_name, migratedProject.destination_type )">
              Some problems  <span class="sr-only"> on migration of {{migratedProject.tool_name}} for {{migratedProject.site_name}}</span></a>
          </small>
          &nbsp;
          <small ng-if="migratedProject.status.data && migratedProject.status.data.length ===0 || migratedProject.status.data.length > 0 || migratedProject.status.counts.length">Old export format</small>
          <span ng-show="migratedProject.status.status==='OK' && !(migratedProject.status.data && migratedProject.status.data.length ===0 || migratedProject.status.data.length > 0)" class="glyphicon glyphicon-ok"></span>
          <span ng-show="migratedProject.status.status==='PARTIAL'" class="glyphicon glyphicon-exclamation-sign"></span>
          <span ng-show="migratedProject.status.status==='ERROR'" class="glyphicon glyphicon-warning-sign"></span>
        </div>
		  	</div>
		  </div>
		</li>
	</ul>
</div>
